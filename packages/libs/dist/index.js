export function getDomElement(e){let t=null;if(e)return t=e instanceof HTMLElement||e instanceof Document?e:[".","#"].includes(e.substr(0,1))?document.querySelector(e):document.querySelector(`${e}`)||document.querySelector(`#${e}`)||document.querySelector(`.${e}`),t}export function isScrollIntoView(e,t){const o=getDomElement(e);if(o){const e=Math.min(window.innerHeight,window.outerHeight),t=document.body.scrollTop||document.documentElement.scrollTop,n=getRectFromView(o),r={bottom:t+e,top:t};if(n.top>=r.top&&n.top<=r.bottom||n.bottom>=r.top&&n.bottom<=r.bottom)return!0}return!1}export function getRectFromView(e){const t=getDomElement(e);return t?t.getBoundingClientRect?{...t.getBoundingClientRect(),el:t}:(e=>{let t={top:0,bottom:0,left:0,right:0,height:e.offsetHeight,width:e.offsetWidth,el:e};const o=n=>n&&n instanceof HTMLElement&&(t={...t,top:t.top+n.offsetTop,bottom:t.top+n.offsetTop+e.offsetHeight,left:t.left+n.offsetLeft,right:t.left+n.offsetLeft+e.offsetWidth},n.offsetParent)?o(n.offsetParent):t;return o(e)})(t):{top:0,bottom:0,left:0,right:0,height:0,width:0,el:null}}export function mouseMoveObsever(e){const{el:t,moveLeft:o,moveRight:n,moveTop:r,moveBottom:l,once:s}={el:null,moveLeft:()=>{},moveRight:()=>{},moveTop:()=>{},moveBottom:()=>{},once:!0,...e,el:getDomElement(e.el)};if(!(t instanceof HTMLElement))return console.error("el不是HTMLElement类型");let c,i,a,u,m,d,f,g;function h(e){s&&(f=!0),c=e.changedTouches[0].pageX,i=e.changedTouches[0].pageY}function p(e){g!==e&&s&&(f=!0)}function y(e){a=e.changedTouches[0].pageX,u=e.changedTouches[0].pageY,m=a-c,d=u-i,c=a,i=u,m>0?(p("right"),g="right",f&&n instanceof Function&&n()):m<0?(p("left"),g="left",f&&o instanceof Function&&o()):d>0?(p("top"),g="top",r instanceof Function&&r()):d<0?(p("bottom"),g="bottom",l instanceof Function&&l()):console.log("anything else"),s&&(f=!1)}return{register(){t.addEventListener("touchstart",h),t.addEventListener("touchmove",y)},destroy(){t.removeEventListener("touchstart",h),t.removeEventListener("touchmove",y)}}}export function getTargetNodeBySourceDom(e){const t={el:null,include:{class:null,id:null,attrs:[],isCorss:!0},exclude:{class:null,id:null,attrs:[],isCorss:!1},...e,el:getDomElement(e.el)},{el:o,include:n,exclude:r}=t,l=(e,t)=>{return e instanceof HTMLElement?(o=e?.classList,[...o])?.includes(t):[];var o},s=e=>{if(e instanceof Document)return null;const t=(t,o)=>{let n=[],r=!0;for(let o in t){const r=t[o];if("isCross"!==o&&("class"===o&&n.push(l(e,r)),"id"===o&&n.push(e.id===r),"attrs"===o&&r.filter((e=>e.key)).length>0)){let t=[];r.filter((e=>e.key)).map((o=>{t.push(o.value===e.getAttribute(o.key))})),n.push(t.length>0&&t.every(Boolean))}}return r=t.isCross?n.length>0&&n.every(Boolean):n.some(Boolean),r},o=t(n),s=t(r);return o&&!s};if(!o)return null;if(s(o))return o;const c=o?.parentNode;return c?s(c)?c:getTargetNodeBySourceDom({...t,el:c}):null}export function imageToBase64(e,t){return new Promise((o=>{let n=document.createElement("canvas");const r=n.getContext("2d"),l=new window.Image;l.crossOrigin="anonymous",l.onload=()=>{n.height=l.height,n.width=l.width,r.drawImage(l,0,0);const e=n.toDataURL(t||"image/png");o(e),n=null},l.src=e}))}const loadPromises={};export function loadScript(e,t={}){return loadPromises[e]?loadPromises[e]:loadPromises[e]=new Promise(((o,n)=>{const r=document.createElement("script");if(r.type=t.type||"text/javascript",r.charset=t.charset||"utf8",r.async=!("async"in t)||!!t.async,r.src=e,t.attrs)for(var l in t.attrs)r.setAttribute(l,t.attrs[l]);let s=!1;r.onload=r.onreadystatechange=function(){if(r.readyState&&"complete"!==r.readyState&&"loaded"!==r.readyState||s)return!1;r.onload=r.onreadystatechange=null,s=!0,o()},r.onerror=function(){r.onload=r.onreadystatechange=null,n()};const c=document.getElementsByTagName("head")[0];c.insertBefore(r,c.firstChild)}))}export function loadCSSCode(e){const t=document.createElement("style");t.type="text/css",t.rel="stylesheet",t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t)}export function loadCSS(e){const t=document.createElement("link");t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}export function loadImage(e){return loadPromises[e]?loadPromises[e]:loadPromises[e]=new Promise(((t,o)=>{const n=document.createElement("img");n.src=e,n.onload=function(){t(n)},n.onerror=function(e){n.onload=null,o(e)}}))}export default{getDomElement,getRectFromView,isScrollIntoView,getTargetNodeBySourceDom,imageToBase64,loadScript,loadCSSCode,loadCSS,loadImage};